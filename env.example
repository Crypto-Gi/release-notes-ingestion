# ============================================
# Cloudflare R2 Configuration
# ============================================
# IMPORTANT: R2_ENDPOINT should be the base URL only, WITHOUT the bucket name
# The bucket name goes in R2_BUCKET_NAME
R2_ENDPOINT=https://your-account-id.r2.cloudflarestorage.com
R2_ACCESS_KEY=your-r2-access-key-here
R2_SECRET_KEY=your-r2-secret-key-here
R2_BUCKET_NAME=releasenotes
R2_SOURCE_PREFIX=source/
R2_MARKDOWN_PREFIX=markdown/

# ============================================
# File Processing Configuration
# ============================================
# Skip files with these extensions (comma-separated, include the dot)
# Example: .DS_Store,.tmp,.log,.cache
SKIP_EXTENSIONS=.DS_Store

# ============================================
# Qdrant Configuration
# ============================================
# Qdrant server host (IP or hostname)
QDRANT_HOST=192.168.254.22

# Qdrant server port (default: 6333)
QDRANT_PORT=6333

# ============================================
# Qdrant Production Settings (Optional)
# ============================================
# Use HTTPS connection (set to 'true' for production)
# Default: false (HTTP for local development)
QDRANT_USE_HTTPS=false

# API key for authentication (required for Qdrant Cloud/production)
# Leave empty for local development without authentication
# QDRANT_API_KEY=your-api-key-here

# ============================================
# Qdrant gRPC Settings (Optional, for performance)
# ============================================
# gRPC port (optional, typically 6334)
# QDRANT_GRPC_PORT=6334

# Prefer gRPC over HTTP (set to 'true' for better performance)
# Default: false
# QDRANT_PREFER_GRPC=false

# Collection names (customize as needed)
# IMPORTANT: Semantic naming for clarity
# - FILENAME_COLLECTION stores filename embeddings (384D, granite-embedding:30m)
# - CONTENT_COLLECTION stores content chunk embeddings (1024D, bge-m3)
QDRANT_FILENAME_COLLECTION=filename-granite-embedding30m
QDRANT_CONTENT_COLLECTION=releasenotes-bge-m3

# ============================================
# Qdrant Collection Configuration - Filename Collection
# ============================================
# Vector dimensions for filename embeddings (default: 384 for granite-embedding:30m)
QDRANT_FILENAME_VECTOR_SIZE=384

# Distance metric: Cosine, Euclid, Dot, Manhattan (default: Cosine)
QDRANT_FILENAME_DISTANCE=Cosine

# Enable text indexing for filename collection (default: true)
QDRANT_FILENAME_TEXT_INDEX=true

# Text tokenizer: word, whitespace, prefix, multilingual (default: word)
# - word: splits on spaces, punctuation, special characters
# - whitespace: splits only on whitespace
# - prefix: like word but creates prefixes
# - multilingual: supports CJK languages
QDRANT_FILENAME_TOKENIZER=word

# Minimum token length (default: 1)
QDRANT_FILENAME_MIN_TOKEN_LEN=1

# Maximum token length (default: 15)
QDRANT_FILENAME_MAX_TOKEN_LEN=15

# Lowercase normalization (default: true)
QDRANT_FILENAME_LOWERCASE=true

# HNSW index configuration
# Number of neighbors per node (default: 16, higher = better recall, more memory)
QDRANT_FILENAME_HNSW_M=16

# Construction parameter (default: 100, higher = better quality, slower build)
QDRANT_FILENAME_HNSW_EF_CONSTRUCT=100

# Full scan threshold (default: 10000)
QDRANT_FILENAME_HNSW_FULL_SCAN_THRESHOLD=10000

# Store HNSW index on disk (default: false, true = saves RAM)
QDRANT_FILENAME_HNSW_ON_DISK=false

# ============================================
# Qdrant Collection Configuration - Content Collection
# ============================================
# Vector dimensions for content embeddings (default: 1024 for bge-m3)
QDRANT_CONTENT_VECTOR_SIZE=1024

# Distance metric: Cosine, Euclid, Dot, Manhattan (default: Cosine)
QDRANT_CONTENT_DISTANCE=Cosine

# Enable text indexing for content collection (default: false, pure vector search)
QDRANT_CONTENT_TEXT_INDEX=false

# HNSW index configuration
# Number of neighbors per node (default: 16)
QDRANT_CONTENT_HNSW_M=16

# Construction parameter (default: 100)
QDRANT_CONTENT_HNSW_EF_CONSTRUCT=100

# Full scan threshold (default: 10000)
QDRANT_CONTENT_HNSW_FULL_SCAN_THRESHOLD=10000

# Store HNSW index on disk (default: false)
QDRANT_CONTENT_HNSW_ON_DISK=false

# ============================================
# Qdrant General Collection Settings
# ============================================
# Number of shards (default: 1)
QDRANT_SHARD_NUMBER=1

# Replication factor (default: 1)
QDRANT_REPLICATION_FACTOR=1

# Write consistency factor (default: 1)
QDRANT_WRITE_CONSISTENCY_FACTOR=1

# Store payload on disk (default: true, saves RAM)
QDRANT_ON_DISK_PAYLOAD=true

# ============================================
# Universal Batch Size Configuration
# ============================================
# Single batch size used for ALL operations:
# - Ollama embedding API calls
# - Gemini embedding API calls  
# - Qdrant vector uploads
# Higher values = fewer API calls but larger payloads (default: 100)
# BATCH_SIZE=100

# ============================================
# Embedding Backend Configuration
# ============================================
# Choose embedding backend: "ollama" or "gemini"
EMBEDDING_BACKEND=ollama

# ============================================
# Ollama Configuration (if EMBEDDING_BACKEND=ollama)
# ============================================
# Ollama server host (IP or hostname)
OLLAMA_HOST=192.168.254.22

# Ollama server port (default: 11434)
OLLAMA_PORT=11434

# Embedding models (can be overridden via environment variables)
OLLAMA_FILENAME_MODEL=granite-embedding:30m
OLLAMA_CONTENT_MODEL=bge-m3

# ============================================
# Ollama Embedding Parameters (Optional)
# ============================================
# All parameters below are OPTIONAL. If not specified or left empty,
# Ollama will use its built-in defaults.

# Truncate input to fit context length (default: true if not specified)
# Set to false to get errors instead of truncation
# OLLAMA_TRUNCATE=true

# Keep model loaded in memory (default: 5m if not specified)
# Examples: "5m", "1h", "24h", "-1" (forever), "0" (unload immediately)
# OLLAMA_KEEP_ALIVE=5m

# Override embedding dimensions (optional, model-specific)
# Only works with models that support dimension reduction
# Leave empty to use model's default dimensions
# OLLAMA_DIMENSIONS=


# ============================================
# Google Gemini Configuration (if EMBEDDING_BACKEND=gemini)
# ============================================
# Google Gemini API key (required for Gemini backend)
# Get your API key from: https://ai.google.dev/
# GEMINI_API_KEY=your-api-key-here

# Gemini model name (default: gemini-embedding-001)
# Note: Use "gemini-embedding-001" (without "models/" prefix for Python SDK)
# GEMINI_MODEL=gemini-embedding-001

# Task type for embeddings (default: RETRIEVAL_DOCUMENT)
# Options: RETRIEVAL_DOCUMENT, RETRIEVAL_QUERY, SEMANTIC_SIMILARITY,
#          CLASSIFICATION, CLUSTERING, QUESTION_ANSWERING, FACT_VERIFICATION
# GEMINI_TASK_TYPE=RETRIEVAL_DOCUMENT

# Output dimensions (default: 768, range: 256-768)
# GEMINI_DIMENSIONS=768


# ============================================
# Docling Service Configuration
# ============================================
# Docling service base URL
DOCLING_BASE_URL=http://192.168.254.22:5010

# Docling conversion timeout in seconds (default: 300)
DOCLING_TIMEOUT=300

# Docling status poll interval in seconds (default: 2)
DOCLING_POLL_INTERVAL=2

# ============================================
# Chunking Configuration
# ============================================
# Target chunk size in tokens (default: 500)
CHUNK_SIZE_TOKENS=500

# Chunk overlap in tokens (default: 0)
CHUNK_OVERLAP_TOKENS=0

# ============================================
# Logging Configuration
# ============================================
# Log directory path
LOG_DIR=logs/

# Log file names
CONVERSION_LOG=conversion.json
UPLOAD_LOG=upload.json
FAILED_LOG=failed.json

# ============================================
# Phase 3: Deduplication & Enhanced Logging
# ============================================
# New log files for embedding and upload tracking
EMBEDDING_LOG=embedding.json
QDRANT_UPLOAD_LOG=qdrant_upload.json
SKIPPED_LOG=skipped.json

# Force reprocess files even if already embedded
# Set to 'true' to skip deduplication checks
FORCE_REPROCESS=false

# Batch size for Qdrant uploads (default: 100)
QDRANT_BATCH_SIZE=100

# Enable detailed embedding logs (default: true)
LOG_EMBEDDINGS=true

# Enable detailed Qdrant upload logs (default: true)
LOG_QDRANT_UPLOADS=true

# Enable skipped files logging (default: true)
LOG_SKIPPED_FILES=true

# ============================================
# N8N Configuration (Optional)
# ============================================
# N8N API key for authentication
N8N_API_KEY=your-n8n-api-key-here

# N8N instance URL
N8N_URL=https://n8n.mynetwork.ing/
